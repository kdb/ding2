!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function($){function e(){$(n).each(function(){$(this).flexMenu({undo:!0}).flexMenu(this.options)})}var i,n=[];$(window).resize(function(){clearTimeout(i),i=setTimeout(function(){e()},200)}),$.fn.flexMenu=function(e){var i,l=$.extend({threshold:2,cutoff:2,linkText:"More",linkTitle:"View More",linkTextAll:"Menu",linkTitleAll:"Open/Close Menu",showOnHover:!0,popupAbsolute:!0,undo:!1},e);return this.options=l,i=$.inArray(this,n),i>=0?n.splice(i,1):n.push(this),this.each(function(){function e(e){return Math.ceil(e.offset().top)>=M+v}var i,n,o,t,f,u,s,a,r=$(this),p=r.find("> li"),d=p.first(),c=p.last(),h=r.find("li").length,M=Math.floor(d.offset().top),v=Math.floor(d.outerHeight(!0)),x=!1;if(e(c)&&h>l.threshold&&!l.undo&&r.is(":visible")){var T=$('<ul class="flexMenu-popup"'+(l.popupAbsolute?" position: absolute;":"")+'"></ul>');d.offset().top;for(u=h;u>1;u--){if(i=r.find("> li:last-child"),n=e(i),i.appendTo(T),u-1<=l.cutoff){$(r.children().get().reverse()).appendTo(T),x=!0;break}if(!n)break}x?r.append('<li class="flexMenu-viewMore flexMenu-allInPopup"><a href="#" title="'+l.linkTitleAll+'">'+l.linkTextAll+"</a></li>"):r.append('<li class="flexMenu-viewMore"><a href="#">'+l.linkText+"</a></li>"),o=r.find("> li.flexMenu-viewMore"),e(o)&&r.find("> li:nth-last-child(2)").appendTo(T),T.children().each(function(e,i){T.prepend(i)}),o.append(T),s=$("ul.flexMenu-popup"),s.wrap("<div class='flex-container'></div>"),a=$(".flexMenu-viewMore"),a.bind("mouseenter",function(e){$(this).addClass("active"),$(this).removeClass("in-active")}),$(".pane-menu-block-main-menu-second-level").bind("mouseleave",function(e){$(this).find(".flexMenu-viewMore").addClass("in-active"),$(this).find(".flexMenu-viewMore").removeClass("active")})}else if(l.undo&&r.find("ul.flexMenu-popup")){for(f=r.find("ul.flexMenu-popup"),t=f.find("li").length,u=1;u<=t;u++)f.find("> li:first-child").appendTo(r);f.remove(),r.find("> li.flexMenu-viewMore").remove()}})}});